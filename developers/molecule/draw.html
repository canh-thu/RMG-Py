

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>9.6. rmgpy.molecule.draw — Drawing of Molecules &mdash; RMG Py 0.1.0 documentation</title>
    
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="RMG Py 0.1.0 documentation" href="../../index.html" />
    <link rel="up" title="9. Molecule API Reference" href="index.html" />
    <link rel="next" title="10. CanTherm API Reference" href="../cantherm/index.html" />
    <link rel="prev" title="9.5. rmgpy.molecule.molecule — Structure and Properties of Molecules" href="molecule.html" /> 
  </head>
  <body>
<div class="header">
&nbsp;
</div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../cantherm/index.html" title="10. CanTherm API Reference"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="molecule.html" title="9.5. rmgpy.molecule.molecule — Structure and Properties of Molecules"
             accesskey="P">previous</a> |</li>
<li><a href="../../index.html">Documentation</a> &raquo;</li>

          <li><a href="../index.html" >RMG Developer&#8217;s Guide</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">9. Molecule API Reference</a> &raquo;</li> 
      </ul>
    </div>
            
  <div class="section" id="module-rmgpy.molecule.draw">
<span id="rmgpy-molecule-draw-drawing-of-molecules"></span><h1>9.6. <a class="reference internal" href="#module-rmgpy.molecule.draw" title="rmgpy.molecule.draw"><tt class="xref py py-mod docutils literal"><span class="pre">rmgpy.molecule.draw</span></tt></a> &#8212; Drawing of Molecules<a class="headerlink" href="#module-rmgpy.molecule.draw" title="Permalink to this headline">¶</a></h1>
<p>This module provides functionality for automatic two-dimensional drawing of the
<a class="reference external" href="http://en.wikipedia.org/wiki/Skeletal_formula">skeletal formulae</a> of a wide
variety of organic and inorganic molecules. The general method for creating
these drawings is to utilize the <tt class="xref py py-meth docutils literal"><span class="pre">draw()</span></tt> method of the <tt class="xref py py-class docutils literal"><span class="pre">Molecule</span></tt>
you wish to draw; this wraps a call to <a class="reference internal" href="#rmgpy.molecule.draw.MoleculeDrawer.draw" title="rmgpy.molecule.draw.MoleculeDrawer.draw"><tt class="xref py py-meth docutils literal"><span class="pre">MoleculeDrawer.draw()</span></tt></a>, where the
molecule drawing algorithm begins. Advanced use may require use of the
<a class="reference internal" href="#rmgpy.molecule.draw.MoleculeDrawer" title="rmgpy.molecule.draw.MoleculeDrawer"><tt class="xref py py-class docutils literal"><span class="pre">MoleculeDrawer</span></tt></a> class directly.</p>
<p>The <a class="reference external" href="http://cairographics.org/">Cairo</a> 2D graphics library is used to create
the drawings. The <a class="reference internal" href="#rmgpy.molecule.draw.MoleculeDrawer" title="rmgpy.molecule.draw.MoleculeDrawer"><tt class="xref py py-class docutils literal"><span class="pre">MoleculeDrawer</span></tt></a> class module will fail gracefully if
Cairo is not installed.</p>
<p>The general procedure for creating drawings of skeletal formula is as follows:</p>
<ol class="arabic simple">
<li><strong>Find the molecular backbone.</strong> If the molecule contains no cycles, the
longest straight chain of heavy atoms is used as the backbone. If the 
molecule contains cycles, the largest independent cycle group is used as the
backbone. The <tt class="xref py py-meth docutils literal"><span class="pre">findBackbone()</span></tt> method is used for this purpose.</li>
<li><strong>Generate coordinates for the backbone atoms.</strong> Straight-chain backbones
are laid out in a horizontal seesaw pattern. Cyclic backbones are laid out
as regular polygons (or as close to this as is possible). The
<tt class="xref py py-meth docutils literal"><span class="pre">generateStraightChainCoordinates()</span></tt> and 
<tt class="xref py py-meth docutils literal"><span class="pre">generateRingSystemCoordinates()</span></tt> methods are used for this purpose.</li>
<li><strong>Generate coordinates for immediate neighbors to backbone.</strong> Each neighbor
atom represents the start of a functional group attached to the backbone.
Generating coordinates for these means that we have determined the bonds
for all backbone atoms. The <tt class="xref py py-meth docutils literal"><span class="pre">generateNeighborCoordinates()</span></tt> method is
used for this purpose.</li>
<li><strong>Continue generating coordinates for atoms in functional groups.</strong> Moving
away from the molecular backbone and its immediate neighbors, the
coordinates for each atom in each functional group are determined such that
the functional groups tend to radiate away from the center of the backbone
(to reduce chances of overlap). If cycles are encountered in the functional
groups, their coordinates are processed as a unit. This continues until
the coordinates of all atoms in the molecule have been assigned. The
<tt class="xref py py-meth docutils literal"><span class="pre">generateFunctionalGroupCoordinates()</span></tt> recursive method is used for
this.</li>
<li><strong>Use the generated coordinates and the atom and bond types to render the
skeletal formula.</strong> The <tt class="xref py py-meth docutils literal"><span class="pre">render()</span></tt>,  and <tt class="xref py py-meth docutils literal"><span class="pre">renderBond()</span></tt>, and
<tt class="xref py py-meth docutils literal"><span class="pre">renderAtom()</span></tt> methods are used for this.</li>
</ol>
<p>The developed procedure seems to be rather robust, but occasionally it will
encounter a molecule that it renders incorrectly. In particular, features which
have not yet been implemented by this drawing algorithm include:</p>
<ul class="simple">
<li>cis-trans isomerism</li>
<li>stereoisomerism</li>
<li>bridging atoms in fused rings</li>
</ul>
<div class="section" id="molecule-drawing">
<h2>9.6.1. Molecule Drawing<a class="headerlink" href="#molecule-drawing" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="rmgpy.molecule.draw.MoleculeDrawer">
<em class="property">class </em><tt class="descclassname">rmgpy.molecule.draw.</tt><tt class="descname">MoleculeDrawer</tt><big>(</big><em>options=None</em><big>)</big><a class="headerlink" href="#rmgpy.molecule.draw.MoleculeDrawer" title="Permalink to this definition">¶</a></dt>
<dd><p>This class provides functionality for drawing the skeletal formula of
molecules using the Cairo 2D graphics engine. The most common use case is
simply:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">MoleculeDrawer</span><span class="p">()</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">molecule</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s">&#39;png&#39;</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s">&#39;molecule.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>where <tt class="docutils literal"><span class="pre">molecule</span></tt> is the <tt class="xref py py-class docutils literal"><span class="pre">Molecule</span></tt> object to draw. You can also
pass a dict of options to the constructor to affect how the molecules are
drawn.</p>
<dl class="method">
<dt id="rmgpy.molecule.draw.MoleculeDrawer.draw">
<tt class="descname">draw</tt><big>(</big><em>molecule</em>, <em>format</em>, <em>path=None</em><big>)</big><a class="headerlink" href="#rmgpy.molecule.draw.MoleculeDrawer.draw" title="Permalink to this definition">¶</a></dt>
<dd><p>Draw the given <cite>molecule</cite> using the given image <cite>format</cite> - pdf, svg, ps, or
png. If <cite>path</cite> is given, the drawing is saved to that location on disk. The
<cite>options</cite> dict is an optional set of key-value pairs that can be used to
control the generated drawing.</p>
<p>This function returns the Cairo surface and context used to create the
drawing, as well as a bounding box for the molecule being drawn as the
tuple (<cite>left</cite>, <cite>top</cite>, <cite>width</cite>, <cite>height</cite>).</p>
</dd></dl>

<dl class="method">
<dt id="rmgpy.molecule.draw.MoleculeDrawer.render">
<tt class="descname">render</tt><big>(</big><em>cr</em>, <em>offset=None</em><big>)</big><a class="headerlink" href="#rmgpy.molecule.draw.MoleculeDrawer.render" title="Permalink to this definition">¶</a></dt>
<dd><p>Uses the Cairo graphics library to create a skeletal formula drawing of a
molecule containing the list of <cite>atoms</cite> and dict of <cite>bonds</cite> to be drawn.
The 2D position of each atom in <cite>atoms</cite> is given in the <cite>coordinates</cite> array.
The symbols to use at each atomic position are given by the list <cite>symbols</cite>.
You must specify the Cairo context <cite>cr</cite> to render to.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="reaction-drawing">
<h2>9.6.2. Reaction Drawing<a class="headerlink" href="#reaction-drawing" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="rmgpy.molecule.draw.ReactionDrawer">
<em class="property">class </em><tt class="descclassname">rmgpy.molecule.draw.</tt><tt class="descname">ReactionDrawer</tt><big>(</big><em>options=None</em><big>)</big><a class="headerlink" href="#rmgpy.molecule.draw.ReactionDrawer" title="Permalink to this definition">¶</a></dt>
<dd><p>This class provides functionality for drawing chemical reactions using the
skeletal formula of each reactant and product molecule via the Cairo 2D
graphics engine. The most common use case is simply:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">ReactionDrawer</span><span class="p">()</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">reaction</span><span class="p">,</span> <span class="n">format</span><span class="o">=</span><span class="s">&#39;png&#39;</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s">&#39;reaction.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>where <tt class="docutils literal"><span class="pre">reaction</span></tt> is the <tt class="xref py py-class docutils literal"><span class="pre">Reaction</span></tt> object to draw. You can also
pass a dict of options to the constructor to affect how the molecules are
drawn.</p>
<dl class="method">
<dt id="rmgpy.molecule.draw.ReactionDrawer.draw">
<tt class="descname">draw</tt><big>(</big><em>reaction</em>, <em>format</em>, <em>path=None</em><big>)</big><a class="headerlink" href="#rmgpy.molecule.draw.ReactionDrawer.draw" title="Permalink to this definition">¶</a></dt>
<dd><p>Draw the given <cite>reaction</cite> using the given image <cite>format</cite> - pdf, svg, 
ps, or png. If <cite>path</cite> is given, the drawing is saved to that location
on disk.</p>
<p>This function returns the Cairo surface and context used to create the
drawing, as well as a bounding box for the molecule being drawn as the
tuple (<cite>left</cite>, <cite>top</cite>, <cite>width</cite>, <cite>height</cite>).</p>
</dd></dl>

</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div class="sidebarlogo">
<img src="../../_static/rmg-logo-small.png" alt="RMG" />
</div>
  <h3><a href="../../contents.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">9.6. <tt class="docutils literal"><span class="pre">rmgpy.molecule.draw</span></tt> &#8212; Drawing of Molecules</a><ul>
<li><a class="reference internal" href="#molecule-drawing">9.6.1. Molecule Drawing</a></li>
<li><a class="reference internal" href="#reaction-drawing">9.6.2. Reaction Drawing</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="molecule.html"
                        title="previous chapter">9.5. <tt class="docutils literal"><span class="pre">rmgpy.molecule.molecule</span></tt> &#8212; Structure and Properties of Molecules</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../cantherm/index.html"
                        title="next chapter">10. CanTherm API Reference</a></p>
  <h3>This Page </h3>
  <ul class="this-page-menu">
    <li><a href="https://github.com/GreenGroup/RMG-Py/blob/master/documentation/source/developers/molecule/draw.rst"
           rel="nofollow">Edit this page</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
        &copy; Copyright 2012, William H. Green, Richard H. West, and the RMG Team.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>